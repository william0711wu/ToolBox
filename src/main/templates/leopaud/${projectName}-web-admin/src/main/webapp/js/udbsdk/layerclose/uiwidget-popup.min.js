/**
 * Popup弹出窗口 
 * @author kuanglingxuan@chinaduo.com
 */
;(function($){$.uiwidget=$.uiwidget||{};$.uiwidget.Popup=function(target,cfg){$.extend(this,cfg);this.target=target;this.init()};$.uiwidget.Popup.prototype={dragEnable:false,showMask:true,display:false,isCenter:true,init:function(){var t=this;if(t.dragEnable&&$.uiwidget.Drag){t.target.drag()}t.target.css({position:'absolute',zIndex:20002});$(window).bind('resize',function(){t.centerLayout()});$(window).bind('scroll',function(){t.centerLayout()})},show:function(){var t=this;t.target.show();t.centerLayout()},hide:function(){var t=this;if(t.showMask){t.getMaskEl().hide()}t.target.hide()},centerLayout:function(){var t=this;if(t.target.css('display')=='none')return;var scrollLeft=(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft);var scrollTop=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);if(t.isCenter){t.target.css({left:($(window).width()-t.target.width())/2+scrollLeft,top:($(window).height()-t.target.height())/2+scrollTop})}else{t.target.css({left:($(window).width()-t.target.width())/2+scrollLeft,top:0+scrollTop})}var markEle=t.getMaskEl();var newHeight = 0;if(document.documentElement.clientHeight >document.body.clientHeight){newHeight = document.documentElement.clientHeight;}else{newHeight = document.body.clientHeight;}var newWidth=document.body.scrollWidth;if(document.body.scrollWidth<=document.body.clientWidth){newWidth=document.body.clientWidth}if($.browser.mozilla){newHeight=$(document).height();newWidth=$(document).width()}markEle.width(newWidth).height(newHeight)},renderMask:function(){var maskContent=$('<div id="popupMask'+this.id+'" class="popup-mask"><iframe frameborder="0" style="width:100%;height:100%;background-color:#000;filter: alpha(opacity=0);-moz-opacity: 0;opacity: 0;"></iframe></div>');$(document.body).append(maskContent);return maskContent},getMaskEl:function(){return this.maskEl||(this.maskEl=this.renderMask())}};$.fn.popup=function(cfg){return new $.uiwidget.Popup(this,cfg)};$.uiwidget.popupShow=function(cfg){var t=$('#'+cfg.id);var p=$.uiwidget.popup=$.uiwidget.popup||{};if(!$(p).attr(cfg.id)){($(p).attr(cfg.id,new $.uiwidget.Popup(t,cfg)))}var obj=$(p).attr(cfg.id);var bh=document.body.clientHeight;var dh=document.documentElement.clientHeight;var isXhtml=(dh<=bh&&dh!=0)?true:false;var htmlbody=isXhtml?document.documentElement:document.body;var isScroll=true;if(typeof(cfg.isScroll)=="boolean"){isScroll=cfg.isScroll;obj.isCenter=cfg.isScroll}if(!isScroll){htmlbody.style.overflow="hidden"}obj.show();return obj};$.uiwidget.popupHide=function(cfg){var obj=$($.uiwidget.popup).attr(cfg.id);if(obj){if(!obj.isCenter){var bh=document.body.clientHeight;var dh=document.documentElement.clientHeight;var isXhtml=(dh<=bh&&dh!=0)?true:false;var htmlbody=isXhtml?document.documentElement:document.body;htmlbody.style.overflowY="auto"}obj.hide();$($.uiwidget.popup).attr(cfg.id,null);$('#popupMask'+cfg.id).remove()}};$.uiwidget.showMsgbox=function(msg,time,callback,flag){var scrollLeft=(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft);var scrollTop=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);var MsgBox=document.createElement("div");MsgBox.className="popup-msgbox";if(flag==0){MsgBox.innerHTML='<span class="fail">'+msg+'</span>'}else{MsgBox.innerHTML='<span class="success">'+msg+'</span>'}document.body.appendChild(MsgBox);MsgBox.style.position="absolute";MsgBox.style.zIndex=20005;MsgBox.style.display="block";MsgBox.style.left=scrollLeft+(($(window).width()-$(MsgBox).width())/2)+'px';MsgBox.style.top=scrollTop+(($(window).height()-$(MsgBox).width())/2)+'px';window.setTimeout(function(){document.body.removeChild(MsgBox);if(callback){callback()}},time)}})(jQuery);